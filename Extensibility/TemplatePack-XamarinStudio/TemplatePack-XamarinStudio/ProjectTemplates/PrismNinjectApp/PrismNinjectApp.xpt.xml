<?xml version="1.0"?>
<Template>
	<TemplateConfiguration>
		<_Name>Prism Ninject App</_Name>
		<Image id="prism-project-xamarin-forms"/>
		<Icon>md-project</Icon>
		<_Category>crossplat/app/forms</_Category>
		<LanguageName>C#</LanguageName>
	    <SupportedParameters>CrossPlatIdentifiers, TargetPlatform, SharedCode</SupportedParameters>
		<Wizard>Xamarin.Forms.ProjectTemplateWizard</Wizard>
		<_Description>Creates a Xamarin.Forms app using a Shared Project or Portable Class Library using Prism and Ninject.</_Description>
	</TemplateConfiguration>
	<Actions>
	</Actions>

	<Combine name="${ProjectName}" directory=".">
		<Options>
			<StartupProject>${ProjectName}.iOS</StartupProject>
		</Options>

		<Actions>
			<Open filename = "App.xaml.cs"/>
		</Actions>

		<Project name = "${ProjectName}" directory = "." type = "SharedAssetsProject" if = "CreateSharedAssetsProject">
			<Files>
				<File name="App.xaml" 
					  BuildAction="EmbeddedResource"
					  CustomTool="MSBuild:UpdateDesignTimeXaml"
					  src="NinjectApp/App.xaml"/>
	        	<File name="App.xaml.cs" 
	        	  	  DependsOn="App.xaml" 
	        	  	  src="NinjectApp/App.xaml.cs"/>

	        	<Directory name="Views">
	        		<File name="MainPage.xaml" 
						  BuildAction="EmbeddedResource"
						  CustomTool="MSBuild:UpdateDesignTimeXaml"
						  src="NinjectApp/MainPage.xaml"/>
	        		<File name="MainPage.xaml.cs" 
		        	  	  DependsOn="MainPage.xaml" 
		        	  	  src="NinjectApp/MainPage.xaml.cs"/>
	        	</Directory>

	        	<Directory name="ViewModels">
	        		<File name="MainPageViewModel.cs" src="NinjectApp/MainPageViewModel.cs" />
	        	</Directory>
			</Files>
		</Project>

		<Project name = "${ProjectName}" directory = "." type = "C#PortableLibrary" if = "CreatePortableDotNetProject" >
			<Options Target = "Library" TargetFrameworkVersion = ".NETPortable,Version=v4.5,Profile=Profile78"/>
			<Files>

				<FileTemplateReference TemplateID="CSharpAssemblyInfo" name="AssemblyInfo.cs" />

				<File name="App.xaml" 
					  BuildAction="EmbeddedResource"
					  CustomTool="MSBuild:UpdateDesignTimeXaml"
					  src="NinjectApp/App.xaml"/>
	        	<File name="App.xaml.cs" 
	        	  	  DependsOn="App.xaml" 
	        	  	  src="NinjectApp/App.xaml.cs"/>

	        	<Directory name="Views">
	        		<File name="MainPage.xaml" 
						  BuildAction="EmbeddedResource"
						  CustomTool="MSBuild:UpdateDesignTimeXaml"
						  src="NinjectApp/MainPage.xaml"/>
	        		<File name="MainPage.xaml.cs" 
		        	  	  DependsOn="MainPage.xaml" 
		        	  	  src="NinjectApp/MainPage.xaml.cs"/>
	        	</Directory>

	        	<Directory name="ViewModels">
	        		<File name="MainPageViewModel.cs" src="NinjectApp/MainPageViewModel.cs" />
	        	</Directory>

			</Files>
			<Packages>
				<Package Id="Xamarin.Forms" Version="2.3.0.49"/> 
				<Package ID="Xamarin.Insights" Version="1.12.3" if="AddInsightsNuget"/>
				<Package Id="Prism.Core" Version="6.2.0-pre1"/>
				<Package Id="Prism.Forms" Version="6.1.0-pre6"/>
				<Package Id="Prism.Ninject.Forms" Version="6.2.0-pre6"/>
			</Packages>
		</Project>

		<Project name = "${ProjectName}.iOS" directory = "./${ProjectName}.iOS" namespace="${ProjectName}" type = "XamarinIOS" if = "CreateMonoTouchProject">
			<Options TargetFrameworkVersion = "Xamarin.iOS,Version=v1.0" DefineConstantsDebug="ENABLE_TEST_CLOUD" />
			<References>
				<Reference type="Gac" refto="System, Version=2.0.5.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e" />
				<Reference type="Gac" refto="System.Xml, Version=2.0.5.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e" />
				<Reference type="Gac" refto="System.Core, Version=2.0.5.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e" />
				<Reference type="Gac" refto="Xamarin.iOS" />
				<Reference type="Project" refto="${ProjectName}"/>
			</References>
			<Files>
				<Directory name="Resources">
					<Directory name="Images.xcassets">
						<Directory name="AppIcons.appiconset">
							<RawFile name="Contents.json" SuppressAutoOpen="False" BuildAction="ImageAsset" src="NinjectApp.iOS/AppIcons/AppIcons.json" />
						</Directory>
					</Directory>
					<File name="LaunchScreen.xib" AddStandardHeader="False" SuppressAutoOpen="True" src="NinjectApp.iOS/LaunchScreen.xib" />
				</Directory>
				<File name="Info.plist" AddStandardHeader="False" src="NinjectApp.iOS/Info_Universal.plist.xml" />
				<File name="Entitlements.plist" AddStandardHeader="False" src="NinjectApp.iOS/Entitlements.plist.xml" />
				<File name="Main.cs" AddStandardHeader="True" src="NinjectApp.iOS/Main.cs" />
				<File name="AppDelegate.cs" AddStandardHeader="True" src="NinjectApp.iOS/AppDelegate.cs" />
				<File name="PlatformInitializer.cs" AddStandardHeader="True" src="NinjectApp.iOS/PlatformInitializer.cs" />
			
			</Files>
			<Packages>
				<Package Id="Xamarin.Forms" Version="2.3.0.49"/>
				<Package ID="Xamarin.TestCloud.Agent" Version="0.19.1" if="CreateUITestProject"/>
				<Package Id="Prism.Core" Version="6.2.0-pre1"/>
				<Package Id="Prism.Forms" Version="6.1.0-pre6"/>
				<Package Id="Prism.Ninject.Forms" Version="6.2.0-pre6"/>
			</Packages>
		</Project>

		<Project name = "${ProjectName}.Droid" directory = "./${ProjectName}.Droid" namespace="${ProjectName}" type = "MonoDroid" if = "CreateAndroidProject">
			<Options
				AndroidApplication="true"
				AndroidResgenFile="Resources/Resource.designer.cs"
				AndroidResgenClass="Resource"
				AndroidUseLatestPlatformSdk="True" />
			<References>
				<Reference type="Gac" refto="System, Version=2.0.5.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e" />
				<Reference type="Gac" refto="System.Xml, Version=2.0.5.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e" />
				<Reference type="Gac" refto="System.Core, Version=2.0.5.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e" />
				<Reference type="Gac" refto="Mono.Android" />
				<Reference type="Project" refto="${ProjectName}"/>
			</References>
			<Files>
				<File name="MainActivity.cs" src="NinjectApp.Droid/MainActivity.cs" />
				<File name="PlatformInitializer.cs" src="NinjectApp.Droid/PlatformInitializer.cs" />
				<File name="SplashScreenActivity.cs" src="NinjectApp.Droid/SplashScreenActivity.cs" />
				<Directory name="Resources">
					<File name="Resource.designer.cs" src="NinjectApp.Droid/Resource.cs" />
					<RawFile name="AboutResources.txt" src="NinjectApp.Droid/AboutResources.txt" />
					<Directory name="layout">
						<RawFile name="SplashScreen.axml" src="NinjectApp.Droid/SplashScreenlayout.xml" />
						<RawFile name="tabs.axml" src="NinjectApp.Droid/tabslayout.xml" />
						<RawFile name="toolbar.axml" src="NinjectApp.Droid/toolbarlayout.xml" />
					</Directory>
					<Directory name="values">
						<RawFile name="colors.axml" src="NinjectApp.Droid/colorsvalues.xml" />
						<RawFile name="styles.axml" src="NinjectApp.Droid/stylesvalues.xml" />
					</Directory>
					<Directory name="values-v21">
						<RawFile name="styles.axml" src="NinjectApp.Droid/stylesvalues-v21.xml" />
					</Directory>
					<Directory name ="drawable">
						<RawFile name="icon.png" src="NinjectApp.Droid/icondrawable.png" />
					</Directory>
					<Directory name ="drawable-hdpi">
						<RawFile name="icon.png" src="NinjectApp.Droid/icondrawablehdpi.png" />
					</Directory>
					<Directory name ="drawable-xhdpi">
						<RawFile name="icon.png" src="NinjectApp.Droid/icondrawablexhdpi.png" />
					</Directory>
					<Directory name ="drawable-xxhdpi">
						<RawFile name="icon.png" src="NinjectApp.Droid/icondrawablexxhdpi.png" />
					</Directory>
				</Directory>
				<Directory name="Properties">
					<File name="AssemblyInfo.cs" src="NinjectApp.Droid/AssemblyInfo.cs" />
					<File name="AndroidManifest.xml" AddStandardHeader="False" src="NinjectApp.Droid/AndroidManifest.xml" BuildAction="None" />
				</Directory>
				<Directory name="Assets">
					<RawFile name="AboutAssets.txt" src="NinjectApp.Droid/AboutAssets.txt" BuildAction="None" />
				</Directory>
			</Files>
			<Packages>
				<Package Id="Xamarin.Android.Support.v4" Version="23.3.0" />
				<Package Id="Xamarin.Forms" Version="2.3.0.49"/> 
				<Package Id="Prism.Core" Version="6.2.0-pre1"/>
				<Package Id="Prism.Forms" Version="6.1.0-pre6"/>
				<Package Id="Prism.Ninject.Forms" Version="6.2.0-pre6"/>
			</Packages>
		</Project>

		<Project name = "${ProjectName}.UITests" directory = "./${ProjectName}.UITests" if = "CreateUITestProject">
			<Options Target = "Library" />
			
			<References>
				<Reference type="Package" refto="System, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
				<Reference type="Project" refto="${ProjectName}.iOS" LocalCopy = "false" ReferenceOutputAssembly = "false" if = "CreateMonoTouchProject" />
				<Reference type="Project" refto="${ProjectName}.Droid" LocalCopy = "false" ReferenceOutputAssembly = "false" if = "CreateAndroidProject" />
			</References>

			<Files>
				<File name="Tests.cs" src="NinjectApp.UITests/UITests.AppProject.cs" if = "CreateCrossPlatformUITest" />
				<File name="Tests.cs" src="NinjectApp.UITests/UITests.AppProject.Android.cs" if = "CreateAndroidUITest" />
				<File name="Tests.cs" src="NinjectApp.UITests/UITests.AppProject.iOS.cs" if = "CreateiOSUITest" />
				<File name="AppInitializer.cs" src="NinjectApp.UITests/AppInitializer.AppProject.cs" if = "CreateCrossPlatformUITest" />
			</Files>

			<Packages>
				<Package ID="NUnit" Version="3.2.1" />
				<Package ID="Xamarin.UITest" Version="1.3.8" />
			</Packages>
		</Project>

	</Combine>

</Template>
